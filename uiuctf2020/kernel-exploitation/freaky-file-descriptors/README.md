# Kernel Memory Leak

## Challenge Description

> How does the OS know what bytes to give you when you call read? How does it keep track of how far you've read into a file?
>
> Find an exploit that lets you read past the end of /sandb0x/freaky_fds.txt and see what was truncated!

## Cheesy Solution

1. `cd /sandb0x/freaky_fds.txt`
    * Note that `freaky_fds.txt` is not a directory, but a file (smirk)
2. `ls`

Then the flag presents itself to you and is<br/>
`uiuctf{b0y_1_sur3_d0_l0v3_overfl0ws}`

## Non-cheesy solution

Well, the non-cheesy solution would be:

* Use `rash` shell and perform `cat /sandb0x/freaky_fds.txt`. Count how many bytes are being printed, lets say `X`
* Create a shellcode that runs the following algorithm
    1. Open the file `/sandb0x/freaky_fds.txt` with `open` syscall
    2. Use the `read` syscall to read `X` Bytes and discard them.
    3. Use the `read` syscall to read, e.g. `36`, Bytes. These should contain the flag.
    4. Print the Bytes read at step 3. with `write` syscall to `stdout` (In pwnyOS both `stdin` and `stdout` are on file descriptor `0`, unlike Linux)
* Then, use the `binexec` program to run the above shellcode and retrieve the flag
